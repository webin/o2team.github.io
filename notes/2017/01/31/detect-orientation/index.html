<!DOCTYPE html><html class="theme-lattice"><head><meta charset="utf-8"><title>探讨判断横竖屏的最佳实现 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="Javascript,横竖屏,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2017/01/31/detect-orientation/index.html"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/img/favicon-230x230.png" sizes="230x230"><link rel="icon" type="image/png" href="/img/android-chrome-192x192.png" sizes="192x192"><link rel="icon" type="image/png" href="/img/android-chrome-144x144.png" sizes="144x144"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><meta name="msapplication-TileColor" content="#2f83cd"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta property="wb:webmaster" content="a1686eb81db284d5"><meta name="wechat-logo" content="//misc.aotu.io/Tingglelaoo/detect-orientation_200x200.png"><meta name="wechat-title" content="探讨判断横竖屏的最佳实现"><meta name="wechat-desc" content="简述多种横竖屏判断的实现方式以及其中的优缺点，并探讨最佳的实现方式"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="在移动端，判断横竖屏的场景并不少见，比如根据横竖屏以不同的样式来适配，抑或是提醒用户切换为竖屏以保持良好的用户体验。判断横竖屏的实现方法多种多样，本文就此来探讨下目前有哪些实现方法以及其中的优缺点。
CSS Media Queries通过媒体查询的方式，我们可以通过以下方法来实现根据横竖屏不同的情况来适配样式：
1.内联样式1234567@media screen and (orientatio"><meta property="og:type" content="article"><meta property="og:title" content="探讨判断横竖屏的最佳实现"><meta property="og:url" content="https://aotu.io/notes/2017/01/31/detect-orientation/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="在移动端，判断横竖屏的场景并不少见，比如根据横竖屏以不同的样式来适配，抑或是提醒用户切换为竖屏以保持良好的用户体验。判断横竖屏的实现方法多种多样，本文就此来探讨下目前有哪些实现方法以及其中的优缺点。
CSS Media Queries通过媒体查询的方式，我们可以通过以下方法来实现根据横竖屏不同的情况来适配样式：
1.内联样式1234567@media screen and (orientatio"><meta property="og:image" content="https://aotu.io//misc.aotu.io/Tingglelaoo/iPhone-orientation.png"><meta property="og:image" content="https://aotu.io//misc.aotu.io/Tingglelaoo/inset-bars.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/Tingglelaoo/portrait.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/Tingglelaoo/landscape.jpg"><meta property="og:updated_time" content="2017-04-07T10:49:06.687Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="探讨判断横竖屏的最佳实现"><meta name="twitter:description" content="在移动端，判断横竖屏的场景并不少见，比如根据横竖屏以不同的样式来适配，抑或是提醒用户切换为竖屏以保持良好的用户体验。判断横竖屏的实现方法多种多样，本文就此来探讨下目前有哪些实现方法以及其中的优缺点。
CSS Media Queries通过媒体查询的方式，我们可以通过以下方法来实现根据横竖屏不同的情况来适配样式：
1.内联样式1234567@media screen and (orientatio"><meta name="twitter:image" content="https://aotu.io//misc.aotu.io/Tingglelaoo/iPhone-orientation.png"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script><script>window.WechatShareData={imgUrl:"//misc.aotu.io/Tingglelaoo/detect-orientation_200x200.png",link:window.location.href,title:"探讨判断横竖屏的最佳实现",desc:"简述多种横竖屏判断的实现方式以及其中的优缺点，并探讨最佳的实现方式"},window.WechatJSSDKURL="https://aotu.jd.com/aotu-wx-api/api/wx/jssdk/signature"</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://news.aotu.io" class="main-nav-link">资讯</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="//misc.aotu.io/Tingglelaoo/detect-orientation_900x500.png" alt="探讨判断横竖屏的最佳实现"></div><header class="post-hd"><h1 class="post-tit">探讨判断横竖屏的最佳实现</h1><div class="post-meta">by <a target="_blank" href="https://github.com/Tingglelaoo" class="post-author">Tingglelaoo</a> on <span>2017-01-31</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>简述多种横竖屏判断的实现方式以及其中的优缺点，并探讨最佳的实现方式</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><a id="more"></a><p>在移动端，判断横竖屏的场景并不少见，比如根据横竖屏以不同的样式来适配，抑或是提醒用户切换为竖屏以保持良好的用户体验。<br>判断横竖屏的实现方法多种多样，本文就此来探讨下目前有哪些实现方法以及其中的优缺点。</p><h2 id="CSS-Media-Queries" class="post-heading"><a href="#CSS-Media-Queries" class="headerlink" title="CSS Media Queries"></a>CSS Media Queries<a class="post-anchor" href="#CSS-Media-Queries" aria-hidden="true"></a></h2><p>通过媒体查询的方式，我们可以通过以下方法来实现根据横竖屏不同的情况来适配样式：</p><h3 id="1-内联样式" class="post-heading"><a href="#1-内联样式" class="headerlink" title="1.内联样式"></a>1.内联样式<a class="post-anchor" href="#1-内联样式" aria-hidden="true"></a></h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">media</span> screen and (orientation:portrait) &#123;</div><div class="line">    <span class="comment">//竖屏</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">media</span> screen and (orientation:landscape) &#123;</div><div class="line">    <span class="comment">//横屏</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="2-外联样式" class="post-heading"><a href="#2-外联样式" class="headerlink" title="2.外联样式"></a>2.外联样式<a class="post-anchor" href="#2-外联样式" aria-hidden="true"></a></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 竖屏 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"all and (orientation:portrait)"</span> <span class="attr">href</span>=<span class="string">"..."</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 横屏 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"all and (orientation:landscape)"</span> <span class="attr">href</span>=<span class="string">"..."</span> /&gt;</span></div></pre></td></tr></table></figure><h2 id="window-matchMedia" class="post-heading"><a href="#window-matchMedia" class="headerlink" title="window.matchMedia()"></a>window.matchMedia()<a class="post-anchor" href="#window-matchMedia" aria-hidden="true"></a></h2><p>除此之外，<a href="http://www.w3.org/TR/cssom-view/#dom-window-matchmedia" target="_blank" rel="external">CSS Object Model（CSSOM）Views</a> 规范增加了对 JavaScript 操作 CSS Media Queries 的原生支持，它在 window 对象下增加了 matchMedia() 方法，让我们能够通过脚本的方式来实现媒体查询。</p><p><code>window.matchMedia()</code> 方法接受一个 Media Queries 语句的字符串作为参数，返回一个 MediaQueryList 对象。该对象有 media 和 matches 两个属性：</p><ul><li>media：返回所查询的 Media Queries 语句字符串</li><li>matches：返回一个布尔值，表示当前环境是否匹配查询语句</li></ul><p>同时，它还包含了两个方法，用来监听事件：</p><ul><li>addListener(callback)：绑定回调 callback 函数</li><li>removeListener(callback)：注销回调 callback 函数</li></ul><p>那么，通过 <code>window.matchMedia()</code> 的方法，我们可以这样判断横竖屏：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mql = <span class="built_in">window</span>.matchMedia(<span class="string">"(orientation: portrait)"</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onMatchMeidaChange</span>(<span class="params">mql</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(mql.matches) &#123;</div><div class="line">        <span class="comment">// 竖屏</span></div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 横屏</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">onMatchMeidaChange(mql);</div><div class="line">mql.addListener(onMatchMeidaChange);</div></pre></td></tr></table></figure><p>通过<a href="http://caniuse.com/#search=matchmedia" target="_blank" rel="external">Can I Use - matchMeida</a>可以知道，该API在移动端得到良好的支持，并无兼容性问题。</p><h2 id="window-innerHeight-window-innerWidth" class="post-heading"><a href="#window-innerHeight-window-innerWidth" class="headerlink" title="window.innerHeight/window.innerWidth"></a>window.innerHeight/window.innerWidth<a class="post-anchor" href="#window-innerHeight-window-innerWidth" aria-hidden="true"></a></h2><blockquote><p>The ‘orientation’ media feature is ‘portrait’ when the value of the ‘height’ media feature is greater than or equal to the value of the ‘width’ media feature. Otherwise ‘orientation’ is ‘landscape’.<br>—— <a href="https://www.w3.org/community/webed/wiki/CSS/Mediaqueries/orientation" target="_blank" rel="external">CSS/Mediaqueries/orientation</a></p></blockquote><p>在 CSS Media Queries 中，Orientation 属性有两个值：</p><ul><li>portrait，指的是当 height 大于等于 width 的情况</li><li>landscape，指的是当 height 小于 width 的情况</li></ul><p>所以，还有一种最为常见的方法是通过比较页面的宽高，当页面的高大于等于宽时则认为是竖屏，反之则为横屏。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectOrient</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.innerHeight &gt;= <span class="built_in">window</span>.innerWidth) &#123;</div><div class="line">        <span class="comment">// 竖屏</span></div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 横屏 </span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">detectOrient();</div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>,detectOrient);</div></pre></td></tr></table></figure><h2 id="window-orientation" class="post-heading"><a href="#window-orientation" class="headerlink" title="window.orientation"></a>window.orientation<a class="post-anchor" href="#window-orientation" aria-hidden="true"></a></h2><p>在 iOS 平台以及大部分 Android 手机都有支持 <code>window.orientation</code> 这个属性，它返回一个与默认屏幕方向偏离的角度值：</p><ul><li>0：代表此时是默认屏幕方向</li><li>90：代表顺时针偏离默认屏幕方向90度</li><li>-90：代表逆时针偏离默认屏幕方向90度</li><li>180：代表偏离默认屏幕方向180度</li></ul><p>在 iOS 的开发者文档（<a href="https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html" target="_blank" rel="external">iOS Developer Library - Handling Orientation Events</a>）是这样明确定义的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">switch</span>(<span class="built_in">window</span>.orientation) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        displayStr += <span class="string">"Portrait"</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line"></div><div class="line">    <span class="keyword">case</span> <span class="number">-90</span>:</div><div class="line">        displayStr += <span class="string">"Landscape (right, screen turned clockwise)"</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line"></div><div class="line">    <span class="keyword">case</span> <span class="number">90</span>:</div><div class="line">        displayStr += <span class="string">"Landscape (left, screen turned counterclockwise)"</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line"></div><div class="line">    <span class="keyword">case</span> <span class="number">180</span>:</div><div class="line">        displayStr += <span class="string">"Portrait (upside-down portrait)"</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>也就是如下图所示：</p><p></p><div style="margin:0 auto;width:fit-content"><img src="//misc.aotu.io/Tingglelaoo/iPhone-orientation.png" alt="iPhone-orientation.png"></div><br><small style="display:block;text-align:center">（图来自<a href="http://www.williammalone.com/articles/html5-javascript-ios-orientation/" target="_blank" rel="external">William Malone - DETECT IOS DEVICE ORIENTATION WITH JAVASCRIPT</a>）</small><p></p><p>在实际应用中，对于 iPhone 和大部分 Android 是没有180度的手机竖屏翻转的情况的，但是 iPad 是存在的。所以，简化下代码，我们可以绑定<code>orientationchange</code>事件来判断横竖屏：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectOrient</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(<span class="built_in">window</span>.orientation) === <span class="number">90</span>) &#123;</div><div class="line">        <span class="comment">// 横屏</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 竖屏</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">detectOrient();</div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'orientationchange'</span>,detectOrient);</div></pre></td></tr></table></figure><h2 id="影响判断的问题所在" class="post-heading"><a href="#影响判断的问题所在" class="headerlink" title="影响判断的问题所在"></a>影响判断的问题所在<a class="post-anchor" href="#影响判断的问题所在" aria-hidden="true"></a></h2><h3 id="1-对window-orientation属性值的不一致" class="post-heading"><a href="#1-对window-orientation属性值的不一致" class="headerlink" title="1.对window.orientation属性值的不一致"></a>1.对window.orientation属性值的不一致<a class="post-anchor" href="#1-对window-orientation属性值的不一致" aria-hidden="true"></a></h3><p>在 iOS 平台，对 <code>window.orientation</code> 属性值是无异议的，规范当中有明确规定每个值对应的情况。但是对于 Android 平台，就有不一致的特殊情况出现。</p><p><a href="https://notes.matthewgifford.com/a-misconception-about-window-orientation-7231235a94c2#.dm7css274" target="_blank" rel="external">A misconception about window.orientation</a>中作者 Matthew Gifford 就有提到部分 Android 机型(该文章中测试用的 Toshiba Thrive 机型)返回的情况是与期望情况是相反的；除此之外，在 StackOverflow 上也有反馈过这样的问题（例如，<a href="http://stackoverflow.com/questions/14019939/window-orientation-returns-different-values-in-ios-and-android" target="_blank" rel="external">window.orientation returns different values in iOS and Android</a>中提到的 Samsung Tab 2 机型）。</p><p>其实，Matthew Gifford 认为这并不是 BUG（笔者也认同），按照<a href="https://compat.spec.whatwg.org/#event-orientationchange" target="_blank" rel="external">Compatibility Standard - 4.2 window.orientation API</a>规范中的定义，<code>0</code> 值指的是 natural 、 default 的屏幕方向，所以如果生厂商对 natural 、 default 状态是用户应当手持设备方向为横屏，那么 <code>0</code> 值对应为 landscape 的横屏方向了。<br>针对这种不一致情况的出现，对于追求完美的开发者来说，通过 <code>window.orientation</code> 的方法来判断横竖屏则变得有点不可靠的。</p><h3 id="2-软键盘的弹出" class="post-heading"><a href="#2-软键盘的弹出" class="headerlink" title="2.软键盘的弹出"></a>2.软键盘的弹出<a class="post-anchor" href="#2-软键盘的弹出" aria-hidden="true"></a></h3><p>是否除了 <code>window.orientation</code> 的其它方法都是可靠的呢？<br>然而，实际上是事与愿违的。在 Android 下，如果页面中出现软键盘弹出的情况（存在有 Input 的元素）时，页面有时会因为软键盘的弹出而导致页面回缩，即页面的宽度（竖屏时）或者高度（横屏时）被改变。<br>无论是 CSS Media Queries 还是 <code>window.matchMedia()</code> 方法，还是根据 <code>window.innerWidth</code> 、<code>window.innerHeight</code>的页面宽高比对方法来实现的横竖屏判断方法，都会因此受到影响，出现判断失误的情况（ Samsung SCH-i699 机型，在竖屏时由于软键盘弹出导致页面高度小于宽度，被错误地判定为横屏）。<br>所以，在这样的情况下，这几种方式也变得不可靠。</p><h2 id="探讨最佳实现方式" class="post-heading"><a href="#探讨最佳实现方式" class="headerlink" title="探讨最佳实现方式"></a>探讨最佳实现方式<a class="post-anchor" href="#探讨最佳实现方式" aria-hidden="true"></a></h2><p>本着核心的原则——具体情况具体解决来讨论。</p><p>如果你没有遇上以上两个问题所在，恭喜你！上面所提到的方法都可以被应用，选择你最为喜欢的方法就好。</p><p>但是如果想要避免以上两个问题所在，有没有更好的办法呢？</p><p>经过实际情况的研究，针对开发环境兼容的情况（ iOS 与 Android 下的微信内置浏览器与原生浏览器）来说，屏幕分辨率是不会改变的，那么我们可以尝试比对页面宽高和屏幕分辨率来判断横竖屏。</p><p>需要注意的是，微信内置浏览器页面宽度不包括顶栏部分的，而 Android 和 iOS 的原生浏览器都是带有底栏或顶栏兼有的，如下图所示。</p><p></p><div style="margin:0 auto;width:fit-content"><img src="//misc.aotu.io/Tingglelaoo/inset-bars.jpg" alt="inset-bars.jpg"></div><br><small style="display:block;text-align:center">（图为 iPhone 6s 下的微信内置浏览器与原生浏览器截图）</small><p></p><p>那么，我们可以确定为：</p><p>假如屏幕分辨率固定值为：<code>screen.width</code> 和 <code>screen.height</code>（需要注意，这里很重要的一点是：<strong>在移动端，屏幕翻转时，<code>screen.width</code> 和 <code>screen.height</code> 的值依然是不变的</strong>）</p><ul><li>若获取 当前页面的宽（<code>document.documentElement.clientWidth</code>），等于屏幕分辨率的宽(<code>screen.width</code>)，则可认定当前属于<strong>竖屏</strong>。</li></ul><p></p><div style="margin:0 auto;width:fit-content"><img src="//misc.aotu.io/Tingglelaoo/portrait.jpg" alt="portrait.jpg"></div><br><small style="display:block;text-align:center">（图为以 iPhone 6s 竖屏下的微信内置浏览器为例的截图）</small><p></p><ul><li>若获取 当前页面的宽（<code>document.documentElement.clientWidth</code>），等于屏幕分辨率的高(<code>screen.height</code>)，则可认定当前属于<strong>横屏</strong>。</li></ul><p></p><div style="margin:0 auto;width:fit-content"><img src="//misc.aotu.io/Tingglelaoo/landscape.jpg" alt="landscape.jpg"></div><br><small style="display:block;text-align:center">（图为以 iPhone 6s 横屏下的微信内置浏览器为例的截图）</small><p></p><p>如此，对应的代码为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectOrient</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> storage = localStorage;</div><div class="line">    <span class="keyword">var</span> data = storage.getItem(<span class="string">'J-recordOrientX'</span>);</div><div class="line">    <span class="keyword">var</span> w = <span class="built_in">document</span>.documentElement.clientWidth,</div><div class="line">        h = <span class="built_in">document</span>.documentElement.clientHeight;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> _Width = <span class="number">0</span>,</div><div class="line">        _Height = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(!data) &#123;</div><div class="line">        _Width = <span class="built_in">window</span>.screen.width;</div><div class="line">        _Height = <span class="built_in">window</span>.screen.height;</div><div class="line">        storage.setItem(<span class="string">'J-recordOrientX'</span>,_Width + <span class="string">','</span> + _Height);</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">var</span> str = data.split(<span class="string">','</span>);</div><div class="line">        _Width = str[<span class="number">0</span>];</div><div class="line">        _Height = str[<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(w == _Width) &#123;</div><div class="line">        <span class="comment">// 竖屏</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(w == _Height)&#123;</div><div class="line">        <span class="comment">// 横屏</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">detectOrient();</div><div class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>,detectOrient);</div></pre></td></tr></table></figure><p>以上是笔者拙劣的见解，如果你有更好的办法解决，欢迎来分享！</p><h2 id="今后的发展" class="post-heading"><a href="#今后的发展" class="headerlink" title="今后的发展"></a>今后的发展<a class="post-anchor" href="#今后的发展" aria-hidden="true"></a></h2><p>目前，W3C 引入<a href="https://www.w3.org/TR/screen-orientation/" target="_blank" rel="external">Screen Orientation API</a>，该标准能够帮助 Web 应用获得屏幕方向的状态，在状态改变时获得通知，并能够从应用程序中将屏幕状态锁定到特定状态。<br>但截止目前，该标准仍在 W3C 草案阶段。在移动端，它在 Android 和 iOS 平台上仍未得到支持，仅仅在 Chrome for Android 39 版本及以上才得到实现，所以对目前的开发来说意义不大。只能期待它能够尽快通过并得到广泛支持，这样的检测屏幕方向的问题就能够得到规范化的解决。</p><h2 id="参考文档" class="post-heading"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档<a class="post-anchor" href="#参考文档" aria-hidden="true"></a></h2><ul><li><a href="https://notes.matthewgifford.com/a-misconception-about-window-orientation-7231235a94c2#.dm7css274" target="_blank" rel="external">A misconception about window.orientation</a></li><li><a href="https://alxgbsn.co.uk/2012/08/27/trouble-with-web-browser-orientation/" target="_blank" rel="external">Trouble with web browser orientation</a></li><li><a href="https://compat.spec.whatwg.org/#event-orientationchange" target="_blank" rel="external">Compatibility Standard - 4.2 window.orientation API</a></li></ul><div class="post-tags" style="display:none"><a href="/tags/横竖屏/">横竖屏</a> <a href="/tags/Javascript/">Javascript</a></div><div class="post-categories" style="display:none"><a href="/cates/Web开发/">Web开发</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2017/01/31/detect-orientation/">https://aotu.io/notes/2017/01/31/detect-orientation/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2017-04-07T10:49:06.687Z">上次更新：2017-04-07 18:49:06</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2017/02/16/2d-collision-detection/" title="“等一下，我碰！”——常见的2D碰撞检测">“等一下，我碰！”——常见的2D碰撞检测 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2017/01/22/snapsvg/" title="使用 Snap.svg 制作动画"><i class="fa fa-chevron-left"></i> 使用 Snap.svg 制作动画</a></div></div><div class="post-comments" id="comments"><div class="ds-thread" data-thread-key="bm90ZXMvMjAxNy8wMS8zMS9kZXRlY3Qtb3JpZW50YXRpb24v" data-title="探讨判断横竖屏的最佳实现" data-url="https://aotu.io/notes/2017/01/31/detect-orientation/index.html"></div><script type="text/javascript">var duoshuoQuery={short_name:"aotu"};!function(){var t=document.createElement("script");t.id="duoshuo-script",t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script></div></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周五推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2017. All Rights Reserved.</p><p><a href="http://www.miibeian.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="/js/post_wx_share.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><style>#cnzz_stat_icon_1258539944{display:none}</style><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cspan id='cnzz_stat_icon_1258539944'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s11.cnzz.com/z_stat.php%3Fid%3D1258539944' type='text/javascript'%3E%3C/script%3E"))</script></body></html>